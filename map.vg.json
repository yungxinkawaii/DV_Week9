{
  "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
  "width": 800,
  "height": 450,
  "title": "Number of Chess Players by Country",
  "projection": { "type": "equalEarth" },
  "transform": [
    {
      "lookup": "country",
      "from": {
        "data": {
          "url": "https://raw.githubusercontent.com/yungxinkawaii/DV_Week9/master/data/ne_110m_admin_0_countries.topojson",
          "format": {
            "type": "topojson",
            "feature": "ne_110m_admin_0_countries"
          }
        },
        "key": "objects.ne_110m_admin_0_countries.geometries.properties.SU_A3"
      },
      "as": "geo"
    },
    {
      "aggregate": [{ "op": "count", "field": "name", "as": "player_count" }],
      "groupby": ["geo.properties.name"]
    }
  ],
  "layer": [
    {
      "data": {
        "url": "https://raw.githubusercontent.com/yungxinkawaii/DV_Week9/master/data/ne_110m_admin_0_countries.topojson",
        "format": { "type": "topojson", "feature": "ne_110m_admin_0_countries" }
      },
      "mark": { "type": "geoshape", "fill": "lightgray", "stroke": "white" }
    },
    {
      "data": {
        "url": "https://raw.githubusercontent.com/yungxinkawaii/DV_Week9/master/data/fide_historical.csv"
      },
      "mark": { "type": "circle", "tooltip": { "content": "data" } },
      "encoding": {
        "size": {
            "field": "player_count",
            "type": "quantitative",
            "title": "Number of Players",
            "scale": {"domain": [0, 1000], "type": "linear"}
          }
      }
    }
  ]
}
